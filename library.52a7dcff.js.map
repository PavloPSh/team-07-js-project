{"mappings":"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","sources":["src/lib.js","src/js/popup-modal-lib.js","src/js/watched-btn.js","src/js/queue-btn.js"],"sourcesContent":["import './js/loader.js';\nimport './js/form.js';\nimport './js/modal-registration.js';\nimport './js/apiServiсe.js';\n// import './js/scroll.js';\nimport './js/modal-footer.js';\nimport './js/popup-modal-lib';\nimport './js/watched-btn.js';\nimport './js/queue-btn.js';\nimport './js/auth.js';\n","import filmsAPI from './apiServiсe';\nimport { renderMovieModal } from './renderPopupCard';\nconst trendingFilms = new filmsAPI();\nconst filmCard = document.querySelector('.section');\nfilmCard.addEventListener('click', onFilmCardClick);\n\n// const storage refs\nconst STORAGE_WATCHED = 'Watched:';\nconst STORAGE_QUEUE = 'Queque:';\n\nasync function fetchFilmData(filmID) {\n  const response = await trendingFilms.getFilmID(filmID);\n  return response.data;\n}\n\nfunction onFilmCardClick(e) {\n  e.preventDefault();\n  if (\n    e.target.closest('.card__link')?.querySelector('.card__poster') === undefined\n  ) {\n    return;\n  }\n\n  fetchFilmData(e.target.closest('.card__link').id).then(film => {\n    // pop up fetched movie id\n    let parentId = e.target.closest('.card__link').id;\n\n    //this refs should be there to get active parsed arrays\n    const watchedFilmsArray =\n      JSON.parse(localStorage.getItem(STORAGE_WATCHED)) || [];\n    const queueFilmsArray =\n      JSON.parse(localStorage.getItem(STORAGE_QUEUE)) || [];\n\n    // refs for building labels in first popup buttons loading\n    let isInWatchedBefore;\n    let isInQueueBefore;\n\n    // find if movie is in isInWatchedBefore\n    watchedFilmsArray.find(value => {\n      if (value.id == parentId) {\n        return (isInWatchedBefore = true);\n      } else {\n        return (isInWatchedBefore = false);\n      }\n    });\n\n    // find if movie is in isInWatchedBefore\n    queueFilmsArray.find(value => {\n      if (value.id == parentId) {\n        return (isInQueueBefore = true);\n      } else {\n        return (isInQueueBefore = false);\n      }\n    });\n\n    // popup first loading buttons labels\n    let watchBtnLabel = '';\n    let queueBtnLabel = '';\n\n    //build add or delete to watch label\n    if (isInWatchedBefore) {\n      watchBtnLabel = 'Remove from watched';\n    } else {\n      watchBtnLabel = 'Add to watched';\n    }\n\n    //build add or delete to queue label\n    if (isInQueueBefore) {\n      queueBtnLabel = 'Remove from queue';\n    } else {\n      queueBtnLabel = 'Add to queue';\n    }\n\n    // BUTTONS MAIN LOGIC !!!\n    document.addEventListener('click', e => {\n      // logic for button \"add to watch\"\n      if (\n        e.target.classList.contains('watched-button') &&\n        e.target.getAttribute('data-id') === parentId\n      ) {\n        let isInWatched;\n\n        //find if there is popup movie in watchedFilmsArray\n        watchedFilmsArray.find(value => {\n          if (value.id == parentId) {\n            return (isInWatched = true);\n          } else {\n            return (isInWatched = false);\n          }\n        });\n\n        // logic to delete movie if this movie is in watchedFilmsArray\n        if (isInWatched) {\n          const indexWatchMovieRemove = watchedFilmsArray.findIndex(movie => {\n            return movie.id == parentId;\n          });\n          watchedFilmsArray.splice(indexWatchMovieRemove, 1);\n          localStorage.setItem(\n            STORAGE_WATCHED,\n            JSON.stringify(watchedFilmsArray)\n          );\n          isInWatched = false;\n          e.target.innerText = 'Add to watched';\n          console.log('removed from watched ');\n          return;\n        }\n\n        // logic to add movie if this movie is not in watchedFilmsArray\n        else {\n          watchedFilmsArray.push(film);\n          localStorage.setItem(\n            STORAGE_WATCHED,\n            JSON.stringify(watchedFilmsArray)\n          );\n          isInWatched = true;\n          e.target.innerText = 'Remove to watched';\n          console.log('add to watched ');\n          return;\n        }\n      }\n\n      // logic for button \"add to queue\"\n      if (\n        e.target.classList.contains('queque-button') &&\n        e.target.getAttribute('data-id') === parentId\n      ) {\n        let isInQueue;\n\n        //find if there is popup movie in queueFilmsArray\n        queueFilmsArray.find(value => {\n          if (value.id == parentId) {\n            return (isInQueue = true);\n          } else {\n            return (isInQueue = false);\n          }\n        });\n\n        // logic to delete movie if this movie is in queueFilmsArray\n        if (isInQueue) {\n          const indexQueueMovieRemove = queueFilmsArray.findIndex(movie => {\n            return movie.id == parentId;\n          });\n          queueFilmsArray.splice(indexQueueMovieRemove, 1);\n          localStorage.setItem(STORAGE_QUEUE, JSON.stringify(queueFilmsArray));\n          isInQueue = false;\n          e.target.innerText = 'Add to queue';\n          console.log('removed from queue');\n          return;\n        }\n        // logic to add movie if this movie is not in queueFilmsArray\n        else {\n          queueFilmsArray.push(film);\n          localStorage.setItem(STORAGE_QUEUE, JSON.stringify(queueFilmsArray));\n          isInQueue = true;\n          e.target.innerText = 'Remove from queue';\n          console.log('add to queue ');\n          return;\n        }\n      }\n    });\n\n    // popup render\n    const {\n      title,\n      name,\n      poster_path,\n      id,\n      vote_average,\n      vote_count,\n      popularity,\n      overview,\n      genres,\n    } = film;\n    const genre = [];\n   \n    if(genres.length === 0){\n      genre.push('Unknown');\n    }else{\n      genres.forEach(res => genre.push(res.name));\n    }; \n    try {\n      setTimeout(() => {\n        renderMovieModal(\n          title,\n          name,\n          poster_path,\n          id,\n          vote_average,\n          vote_count,\n          popularity,\n          overview,\n          genre,\n          watchBtnLabel,\n          queueBtnLabel\n        );\n      }, 100);\n    } catch (error) {\n      console.log('error');\n    }\n  });\n}\n\nconst modalRef = document.querySelector('.modal');\nmodalRef?.addEventListener('click', onModalClose);\ndocument.addEventListener('keydown', onModalClose);\n\nfunction onModalClose(e) {\n  if (\n    e.target.classList.contains('popup') ||\n    e.keyCode === 27 ||\n    e.target.classList.contains('popup-button__close')\n  ) {\n    window.location.reload();\n    modalRef.classList.remove('popup');\n    modalRef.innerHTML = '';\n  }\n  \n}","import Notiflix from 'notiflix';\nimport { renderCard } from './renderCard';\nimport { onQueueBtnClick } from './queue-btn';\n\nconst watchedBtn = document.querySelector('button[data-action=\"watched\"]');\nconst queueBtn = document.querySelector('button[data-action=\"queue\"]');\nconst mainSection = document.querySelector('.card__list');\nconst watchedMovies = JSON.parse(localStorage.getItem('Watched:'));\nconst clearBtn = document.querySelector('.clear-btn');\nconst loader = document.querySelector('.loader__wrapper');\n\nwatchedBtn?.addEventListener('click', onWatchBtnClick);\nclearBtn?.addEventListener('click', onClearBtnClick);\n\nfirstBtnActive();\n\nfunction firstBtnActive() {\n  if (localStorage.getItem('last-active-btn') === 'watchedButton') {\n    return onWatchBtnClick()\n  }\n\n  if (localStorage.getItem('last-active-btn') === 'queueButton') {\n    return onQueueBtnClick()\n  } else {\n    onWatchBtnClick()\n  }\n}\n\nfunction onWatchBtnClick() {\n  loader.classList.remove('hidden');\n  watchedBtn.classList.add('current-btn');\n  queueBtn.classList.remove('current-btn');\n  clearBtn.classList.add('clear-btn--visible');\n  localStorage.setItem('last-active-btn', 'watchedButton');\n\n  if (watchedMovies === null || watchedBtn.length === 0) {\n    clearBtn.classList.remove('clear-btn--visible');\n    clearBtn.classList.add('clear-btn');\n    onEmptyMoviesStorage();\n    loader.classList.add('hidden');\n    return Notiflix.Notify.failure('You need to add at least 1 movie.', {timeout: 1500, clickToClose: true});\n  }\n\n  mainSection.innerHTML = '';\n\n  renderWatchedCard();\n  loader.classList.add('hidden');\n}\n\nfunction renderWatchedCard() {\n  const watchedL = watchedMovies.map(film => {\n    const genres = film.genres.map(genre => genre.name);\n\n    renderCard(\n      film.id,\n      film.poster_path,\n      film.title,\n      film.name,\n      genres,\n      film.first_air_date,\n      film.release_date,\n      film.vote_average\n    );\n  });\n}\n\nexport function onEmptyMoviesStorage() {\n  const notificationText = `<li class=\"card__notification\">You don't have any movies added</li>`;\n  mainSection.innerHTML = notificationText;\n}\n\nfunction onClearBtnClick() {\n  if (watchedBtn.classList.contains('current-btn')) {\n    localStorage.removeItem('Watched:');\n    location.reload();\n  }\n}","import Notiflix from 'notiflix';\nimport { renderCard } from './renderCard';\nimport { onEmptyMoviesStorage } from './watched-btn';\n\nconst queueBtn = document.querySelector('button[data-action=\"queue\"]');\nconst watchedBtn = document.querySelector('button[data-action=\"watched\"]');\nconst mainSection = document.querySelector('.card__list');\nconst queueMovies = JSON.parse(localStorage.getItem('Queque:'));\nconst clearBtn = document.querySelector('.clear-btn');\nconst loader = document.querySelector('.loader__wrapper');\n\nqueueBtn?.addEventListener('click', onQueueBtnClick);\nclearBtn?.addEventListener('click', onClearBtnClick);\n\nexport function onQueueBtnClick() {\n  loader.classList.remove('hidden');\n  watchedBtn.classList.remove('current-btn');\n  queueBtn.classList.add('current-btn');\n  clearBtn.classList.add('clear-btn--visible');\n  localStorage.setItem('last-active-btn', 'queueButton');\n\n  if (queueMovies === null || queueMovies.length === 0) {\n    clearBtn.classList.remove('clear-btn--visible');\n    clearBtn.classList.add('clear-btn');\n    onEmptyMoviesStorage();\n    loader.classList.add('hidden');\n    return Notiflix.Notify.failure('You need to add at least 1 movie.', {timeout: 1500, clickToClose: true});\n  }\n\n  mainSection.innerHTML = '';\n\n  renderQueueCard();\n  loader.classList.add('hidden');\n}\n\nfunction renderQueueCard() {\n  const queueList = queueMovies.map(film => {\n    const genres = film.genres.map(genre => genre.name);\n\n    renderCard(\n      film.id,\n      film.poster_path,\n      film.title,\n      film.name,\n      genres,\n      film.first_air_date,\n      film.release_date,\n      film.vote_average\n    );\n  });\n}\n\nfunction onClearBtnClick() {\n  if (queueBtn.classList.contains('current-btn')) {\n    localStorage.removeItem('Queque:');\n    location.reload();\n  }\n}"],"names":["require","parcelHelpers","_renderPopupCard","trendingFilms","default","document","querySelector","addEventListener","e1","ref","preventDefault","undefined","target","closest","filmID","_fetchFilmData","apply","this","arguments","fetchFilmData","id","then","film","isInWatchedBefore","isInQueueBefore","parentId","watchedFilmsArray","JSON","parse","localStorage","getItem","STORAGE_WATCHED","queueFilmsArray","STORAGE_QUEUE","find","value","watchBtnLabel","queueBtnLabel","e","classList","contains","getAttribute","isInWatched","indexWatchMovieRemove","findIndex","movie","splice","setItem","stringify","innerText","console","log","push","isInQueue","indexQueueMovieRemove","title","name","poster_path","vote_average","vote_count","popularity","overview","genres","genre","length","forEach","res","setTimeout","renderMovieModal","error","_asyncToGeneratorJsDefault","_regeneratorRuntimeDefault","mark","_callee","response","getFilmID","_ctx","sent","data","modalRef","onModalClose","keyCode","window","location","reload","remove","innerHTML","export","exports","onEmptyMoviesStorage","_notiflix","_renderCard","_queueBtn","watchedBtn","queueBtn","mainSection","watchedMovies","clearBtn","loader","onWatchBtnClick","add","_notiflixDefault","Notify","failure","timeout","clickToClose","map","renderCard","first_air_date","release_date","removeItem","onQueueBtnClick","firstBtnActive","_watchedBtn","queueMovies"],"version":3,"file":"library.52a7dcff.js.map"}